import{S as ye,i as ke,s as $e,h as we,e as _e,a as fe,u as ve,t as v,b as q,d as z,c as pe,o as qe,f as A,n as k,g as Z,j as P,k as F,l as ee,m as ne,p as R,q as H,r as te,v as w,w as I,x as O}from"./index.b89b4bd1.js";import{B as Ce}from"./index.38df6bb6.js";import{M as De,f as Ee,C as Me,L as Se,D as me,A as Le,a as Te,b as Ae,S as ue,B as Pe,c as Re}from"./http_client.d7339bf5.js";import{d as Ie}from"./database.0aaf5039.js";import{m as W}from"./model_out.782bba5a.js";import{p as Oe}from"./params.efe350b1.js";function Ve(t){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function Be(t){let c,l,r,o,d,x,e,X,p,C,G,u,D,_,E,m,M,f,V,g,b,B,S,J,L,Y,ae={id:"l1",magic:t[11],exportFunc:"saveToConvex",importFunc:"getFromConvex",dataTable:"Ethiopia_Data",stateTable:"Ethiopia_State",client:t[13]};r=new Se({props:ae}),t[14](r);let re={id:"Village_Dropdown",index:0,dropdown_key:"village"};d=new me({props:re}),t[15](d);let le={id:"Alert",threshold_string:"1.0",key:"combined_payout"};e=new Le({props:le}),t[16](e);let ie={id:"lc1",name:"line",title:"Climatology",magic:t[11],xAttr:"dekad",yAttr:"average_value",xDomainMin:"1",xDomainMa:"36"};C=new Te({props:ie}),t[17](C);let se={name:"testCropCal",id:"cc1",magic:t[11],xDomainMin:"1",xDomainMax:"36"};u=new Ae({props:se}),t[18](u);let oe={min:"1",max:"36",id:"PlantEarly",description:"CHIRPS sum early"};_=new ue({props:oe}),t[19](_);let de={min:"1",max:"36",id:"PlantLate",description:"CHIRPS sum late"};m=new ue({props:de}),t[20](m);let n={min:"1",max:"36",id:"Vegetation",description:"Vegetation"};f=new ue({props:n}),t[21](f);let K={id:"bgc1",name:"Bar Grouped",title:"Payouts",magic:t[11],groupNames:["sum_early","sum_late","vegetation","combined_payout"],xAttr:"year",yAttr:"value",yMax:"1",xDomainMin:"1981",xDomainMax:"2021"};b=new Pe({props:K}),t[22](b);let Q={id:"d2",index:0,dropdown_key:"value"};S=new me({props:Q}),t[23](S);let j={name:"Matching Table",id:"m1"};return L=new Re({props:j}),t[24](L),{c(){c=Z("div"),l=Z("div"),P(r.$$.fragment),o=F(),P(d.$$.fragment),x=F(),P(e.$$.fragment),X=F(),p=Z("div"),P(C.$$.fragment),G=F(),P(u.$$.fragment),D=F(),P(_.$$.fragment),E=F(),P(m.$$.fragment),M=F(),P(f.$$.fragment),V=F(),g=Z("div"),P(b.$$.fragment),B=F(),P(S.$$.fragment),J=F(),P(L.$$.fragment),this.h()},l(a){c=ee(a,"DIV",{class:!0});var T=ne(c);l=ee(T,"DIV",{class:!0});var $=ne(l);R(r.$$.fragment,$),o=H($),R(d.$$.fragment,$),x=H($),R(e.$$.fragment,$),$.forEach(z),X=H(T),p=ee(T,"DIV",{class:!0});var h=ne(p);R(C.$$.fragment,h),G=H(h),R(u.$$.fragment,h),D=H(h),R(_.$$.fragment,h),E=H(h),R(m.$$.fragment,h),M=H(h),R(f.$$.fragment,h),h.forEach(z),V=H(T),g=ee(T,"DIV",{class:!0});var y=ne(g);R(b.$$.fragment,y),B=H(y),R(S.$$.fragment,y),J=H(y),R(L.$$.fragment,y),y.forEach(z),T.forEach(z),this.h()},h(){te(l,"class","grid items-center py-2 col-span-1 md:col-span-2 lg:col-span-2"),te(p,"class","grid col-span-1"),te(g,"class","col-span-1"),te(c,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2")},m(a,T){fe(a,c,T),w(c,l),I(r,l,null),w(l,o),I(d,l,null),w(l,x),I(e,l,null),w(c,X),w(c,p),I(C,p,null),w(p,G),I(u,p,null),w(p,D),I(_,p,null),w(p,E),I(m,p,null),w(p,M),I(f,p,null),w(c,V),w(c,g),I(b,g,null),w(g,B),I(S,g,null),w(g,J),I(L,g,null),Y=!0},p(a,T){const $={};r.$set($);const h={};d.$set(h);const y={};e.$set(y);const N={};C.$set(N);const i={};u.$set(i);const s={};_.$set(s);const U={};m.$set(U);const ge={};f.$set(ge);const ce={};b.$set(ce);const he={};S.$set(he);const be={};L.$set(be)},i(a){Y||(v(r.$$.fragment,a),v(d.$$.fragment,a),v(e.$$.fragment,a),v(C.$$.fragment,a),v(u.$$.fragment,a),v(_.$$.fragment,a),v(m.$$.fragment,a),v(f.$$.fragment,a),v(b.$$.fragment,a),v(S.$$.fragment,a),v(L.$$.fragment,a),Y=!0)},o(a){q(r.$$.fragment,a),q(d.$$.fragment,a),q(e.$$.fragment,a),q(C.$$.fragment,a),q(u.$$.fragment,a),q(_.$$.fragment,a),q(m.$$.fragment,a),q(f.$$.fragment,a),q(b.$$.fragment,a),q(S.$$.fragment,a),q(L.$$.fragment,a),Y=!1},d(a){a&&z(c),t[14](null),O(r),t[15](null),O(d),t[16](null),O(e),t[17](null),O(C),t[18](null),O(u),t[19](null),O(_),t[20](null),O(m),t[21](null),O(f),t[22](null),O(b),t[23](null),O(S),t[24](null),O(L)}}}function Fe(t){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function He(t){let c,l,r={ctx:t,current:null,token:null,hasCatch:!1,pending:Fe,then:Be,catch:Ve,value:35,blocks:[,,,]};return we(t[12],r),{c(){c=_e(),r.block.c()},l(o){c=_e(),r.block.l(o)},m(o,d){fe(o,c,d),r.block.m(o,r.anchor=d),r.mount=()=>c.parentNode,r.anchor=c,l=!0},p(o,d){t=o,ve(r,t,d)},i(o){l||(v(r.block),l=!0)},o(o){for(let d=0;d<3;d+=1){const x=r.blocks[d];q(x)}l=!1},d(o){o&&z(c),r.block.d(o),r.token=null,r=null}}}function Ne(t,c,l){let r,o;pe(t,Ie,n=>l(26,r=n)),pe(t,Oe,n=>l(27,o=n));let d,x=new Ce,e=new De(x);async function X(){return d=await e.backend({id:"defaults_q_backend",type:"query",query:"SELECT gid, chirps_early_first, chirps_early_last, chirps_late_first, chirps_late_last, evi_month FROM admin_raw ORDER BY gid",name:"defaults_q",defaults:o,backend:r}).execute(),d}const p=X();let C=Me;const G=new C("https://rightful-anteater-150.convex.cloud");G.mutation("saveParams"),G.query("getParams");let u=null,D=null,_=null,E=null,m=null,M=null,f=null,V=null,g=null,b=null,B=null;qe(async()=>{await X(),e.view([m,u,V,M,D,_,E,g,f,b,B]);const n=e.backend({id:"village_q_backend",type:"query",query:"SELECT gid, village FROM admin_raw ORDER BY gid",name:"villages",defaults:o,backend:r});e.render(n,u);const K=e.backend({id:"climatology_q_backend",type:"query",query:W.climatology.query,name:"climatology",defaults:o,backend:r});e.render(K,g);const Q=e.backend({id:"crop_cal_q_backend",type:"query",query:W.crop_cal.query,name:"crops",defaults:o,backend:r});e.render(Q,m);const j=e.backend({id:"payout_q_backend",type:"query",query:W.payout_combined.query,name:"payouts",defaults:o,backend:r}),a=e.backend({id:"badyear_q_bbackend",type:"query",query:W.badyear.query,name:"badyear",defaults:o,backend:r});e.render([j,a],M),e.render(j,B);const T=e.backend({id:"matching_q_backend",type:"query",query:W.matching.query,defaults:o,backend:r}),$=e.backend({id:"matching_table_backend",type:"matching",matching:Ee,ignore_cols:["year","gid","value"],default_func:"true positive",backend:T}),h=e.backend({id:"dropdown_matching_q_backend",type:"query",query:"SELECT * FROM (VALUES (0,'true positive'),(1,'true negative'),(2,'average matching')) MATCHING_OPTIONS(idx, value); ",name:"dropdown matching",defaults:null,backend:r});e.render(h,V),e.render($,f);const y=e.backend({id:"overlays",type:"overlay"});e.render(y,[g,m]),e.connect(y,D.drag,{sum_early:{left:i=>i.left,right:i=>i.right}}),e.connect(y,_.drag,{sum_late:{left:i=>i.left,right:i=>i.right}}),e.connect(y,E.drag,{vegetation:{left:i=>i.left,right:i=>i.right}}),[Q,K,j,a,$].forEach(i=>{e.connect(i,D.drag,{sum_early_first:s=>s.left,sum_early_last:s=>s.right}),e.connect(i,_.drag,{sum_late_first:s=>s.left,sum_late_last:s=>s.right}),e.connect(i,E.drag,{vegetation_first:s=>s.left,vegetation_last:s=>s.right}),e.connect(i,u.change,{region:s=>s.gid})}),e.connect($,V.change,{func_elected:i=>i.value}),e.render(M.brushX,M),e.render(g.brushX,g),e.render(B.valid,null);const N=(i,s,U)=>d.filter(ce=>ce[s]===i[0].store.val()[s])[0][U];e.dependencies.add(u.change.get("gid"),D,null,(i,s)=>({left:N(s,"gid","chirps_early_first"),right:N(s,"gid","chirps_early_last")})),e.dependencies.add(u.change.get("gid"),_,null,(i,s)=>({left:N(s,"gid","chirps_late_first"),right:N(s,"gid","chirps_late_last")})),e.dependencies.add(u.change.get("gid"),E,null,(i,s)=>{const U={Sep:{start:24,end:27},Oct:{start:27,end:30},Nov:{start:30,end:33}};return{left:U[N(s,"gid","evi_month")].start,right:U[N(s,"gid","evi_month")].end}}),[n,K,Q,j,a,$,h].forEach(async i=>{await i.execute()}),y.execute([{sum_early:{left:18,right:21},sum_late:{left:25,right:27},vegetation:{left:30,right:33}}])});function S(n){A[n?"unshift":"push"](()=>{b=n,l(9,b)})}function J(n){A[n?"unshift":"push"](()=>{u=n,l(0,u)})}function L(n){A[n?"unshift":"push"](()=>{B=n,l(10,B)})}function Y(n){A[n?"unshift":"push"](()=>{g=n,l(8,g)})}function ae(n){A[n?"unshift":"push"](()=>{m=n,l(4,m)})}function re(n){A[n?"unshift":"push"](()=>{D=n,l(1,D)})}function le(n){A[n?"unshift":"push"](()=>{_=n,l(2,_)})}function ie(n){A[n?"unshift":"push"](()=>{E=n,l(3,E)})}function se(n){A[n?"unshift":"push"](()=>{M=n,l(5,M)})}function oe(n){A[n?"unshift":"push"](()=>{V=n,l(7,V)})}function de(n){A[n?"unshift":"push"](()=>{f=n,l(6,f)})}return[u,D,_,E,m,M,f,V,g,b,B,e,p,G,S,J,L,Y,ae,re,le,ie,se,oe,de]}class ze extends ye{constructor(c){super(),ke(this,c,Ne,He,$e,{},null,[-1,-1])}}export{ze as default};
